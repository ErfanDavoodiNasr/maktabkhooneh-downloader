# ุฏุงูููุฏุฑ ูฺฉุชุจโุฎููู (Maktabkhooneh Downloader)
ุงุจุฒุงุฑ ุฎุท ูุฑูุงู ุจุฑุง ุฏุงูููุฏ ูุฏููุง ูุงุจูโุฏุณุชุฑุณ ุฏูุฑูโูุง ุณุงุช [ูฺฉุชุจโุฎููู](https://maktabkhooneh.org/) ุดุงูู ูุฏููุง ุฏุฑุณโูุงุ ูุงููุง ุถููู ุฏุฑุณุ ุฒุฑููุณ ูุฏูุ ุจู ุดฺฉู ููู ุจุง ููุ ฺฉุฌุง ู ุทุจูู ุจูุฏ ุดุฏู. \
ููุท ูุญุชูุง ุฑุง ูโุชูุงูุฏ ุฏุงูููุฏ ฺฉูุฏ ฺฉู ูุงูููุงู ุจู ุขู ุฏุณุชุฑุณ ุฏุงุฑุฏ.

![maktabkhooneh website screenshot](https://github.com/user-attachments/assets/b54f6fac-10f0-423c-9da2-236c4d8cc5d3)

## ๐ฌ ูุฏู
https://github.com/user-attachments/assets/38ecfd3e-4281-4e20-854d-18ad5dae5691

## โจ ุงูฺฉุงูุงุช
- ูุฑูุฏ ู ูุงฺฏู ุจู ุณุงุช ุจุง ุงูู ู ูพุณูุฑุฏ ุงุฒ ุทุฑู `config.json` ู ุฐุฎุฑู ฺฉูฺฉ ุฏุฑ ูุงู ูุดุณุช ฺูุฏฺฉุงุฑุจุฑู
- ุงุญุฑุงุฒ ููุช ุจุง ฺฉูฺฉ ุงุฒ ุทุฑู `config.json`
- ุชุดุฎุต ู ุงูุชุฎุงุจ ุจูุชุฑู ฺฉูุช ูุฏู ุฏุฑุณ ููุฑุฏ ูุธุฑ
- ูพูุดู ุฎุฑูุฌ ุซุงุจุช: `download/<ูุงู ุฏูุฑู>`
- ุฏุงูููุฏ ุฒุฑููุณ ูุฏููุง ุงฺฏุฑ ููุฌูุฏ ุจุงุดุฏุ ุจุง ููุงู ูุงู ูพุงู ูุฏู
- ุฏุงูููุฏ ูุงูโูุง ุถููู ุฏุฑุณุ ฺฉูุงุฑ ูุฏู
- ููุงุด ุฎูุงุตู ูพุฑููุงู ฺฉุงุฑุจุฑ (ูุถุนุช ูุงฺฏูุ ุงููุ ุงุดุชุฑุงฺฉุ ุฎุฑุฏ ุฏูุฑู)
- ุญุงูุช ูููููโฺฏุฑ (Sample) ุจุง ุฏุงูููุฏ ุชููุง N ุจุงุช ุงูู ูุฑ ูุฏู ุจุฑุง ุชุณุช ุณุฑุน
- ูพุดโููุงุด ูุจู ุงุฒ ุฏุงูููุฏ (Dry Run): ููุงุด ูุณุช ูุงูโูุง + ุญุฌู ุชูุฑุจ ูุฑ ูุณูุช/ูุตู + ุฌูุน ฺฉู
- ุงุฏุงูู ุฏุงูููุฏ ุงุฒ ููุงูโุฌุง (Resume) ุฏุฑ ุตูุฑุช ูุทุน ุดุฏู ุง ุงุฌุฑุง ูุฌุฏุฏ
- ููุงุฑ ูพุดุฑูุช ุฏูู: ุฏุฑุตุฏ + ุญุฌู ุฏุงูููุฏ ุดุฏู / ฺฉู + ุณุฑุนุช ุชูุฑุจ
- ูุงฺฏโูุง ุฑูฺฏ ู ุงููุฌ ุจุฑุง ุฎูุงูุง ู ุชุฌุฑุจู ุจูุชุฑ
- ุฎุทุงูุง ูุงุจูโุงูุฏุงู (Actionable Errors): ุนูุช ุฎุทุง + ุฏุณุชูุฑ ุจุนุฏ ูพุดููุงุฏ

## โ ูพุดโูุงุฒูุง
- โNode.js ูุณุฎู 18 ุง ุจุงูุงุชุฑ
- ฺฉ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฏุฑ maktabkhooneh.org

## ๐ ูุฑูุฏ (Login) ู ูุดุณุช ฺูุฏฺฉุงุฑุจุฑู
ุฏู ุฑุงู ุงุตู ุฏุฑ `config.json`:

1. ุงุณุชูุงุฏู ุงุฒ ุงูู ู ูพุณูุฑุฏ (ูพุดููุงุฏ):
	 ```json
	 {
	   "auth": {
	     "email": "you@example.com",
	     "password": "Secret123"
	   }
	 }
	 ```
	 ุฏุฑ ุงููู ูุฑูุฏุ ฺฉูฺฉ ูุดุณุช (csrftoken + sessionid) ุฏุงุฎู `config.json` ุฏุฑ `auth.sessionCookie` ุฐุฎุฑู ูโุดูุฏ ู ุฏูุนุงุช ุจุนุฏ ุจุฏูู ูุงุฒ ุจู ูพุณูุฑุฏ ุงุณุชูุงุฏู ูโฺฏุฑุฏุฏ (ูฺฏุฑ ุงู ฺฉู ูููุถ ุดูุฏ ุง `--force-login` ุจุฒูุฏ).
2. ุงุณุชูุงุฏู ุงุฒ ฺฉูฺฉ ุขูุงุฏู (Override):
	 ุงฺฏุฑ ููโุฎูุงูุฏ ุงูู/ูพุณูุฑุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏุ ูโุชูุงูุฏ ุฏุฑ `config.json` ููุฏ `auth.cookie` ุง `auth.cookieFile` ุฑุง ุชูุธู ฺฉูุฏ ุชุง ูุงฺฏู ุฎูุฏฺฉุงุฑ ูุงุฏุฏู ฺฏุฑูุชู ุดูุฏ.

### ุณุงุฎุชุงุฑ ูุดุณุช ุฏุฑ config.json
ูุดุณุช ูุนุชุจุฑ ุฏุฑ ููุงู ูุงู `config.json` ูฺฏูุฏุงุฑ ูโุดูุฏ:
```jsonc
{
  "auth": {
    "sessionCookie": "csrftoken=...; sessionid=...",
    "sessionUpdated": "2026-02-10T12:34:56.000Z"
  }
}
```
ุฏุฑ ูุฑ ุงุฌุฑุง ุงฺฏุฑ `auth.sessionCookie` ูุนุชุจุฑ ุจุงุดุฏุ ุงุจุฒุงุฑ ุจุฏูู ูุงฺฏู ูุฌุฏุฏ ุงุฏุงูู ูโุฏูุฏ.

### ุงุฌุจุงุฑ ูุฑูุฏ ูุฌุฏุฏ
ุงฺฏุฑ ูโุฎูุงูุฏ ุจุง ูุฌูุฏ ูุนุชุจุฑ ุจูุฏู ูุดุณุชุ ุฏูุจุงุฑู ูุงฺฏู ุดูุฏ:
```powershell
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --force-login
```

## โ๏ธ ุชูุธู ฺฉูฺฉ (ุฑูุด ุฏุณุช ูุฏู ฺฉู ูพุดููุงุฏ ููโุดูุฏ!)

ุงฺฏุฑ ุชุฑุฌุญ ูโุฏูุฏ ฺฉูฺฉ ุฑุง ุฏุณุช ุณุช ฺฉูุฏ ุง ูุงฺฏู ูุณุชูู ฺฉุงุฑ ูฺฉุฑุฏุ ูุงููุฏ ูุจู ฺฉูฺฉ `sessionid` (ู ุจูุชุฑ: ููุฑุงู csrftoken) ุฑุง ุงุฒ ูุฑูุฑฺฏุฑ ุงุณุชุฎุฑุงุฌ ฺฉูุฏ.

ุจุนุฏ ุงุฒ ุงูฺฉู ุจู ุณุงุช maktabkhooneh.org ูุงฺฏู ุดุฏุฏ. ุฑู ุตูุญู ุฑุงุณุช ฺฉูฺฉ ฺฉุฑุฏู ู inspect ุฑุง ุจุฒูุฏ. (ุง CTRL+SHIFT+i ุจุฒูุฏ) ุจู ุชุจ Network ุจุฑูุฏ. ุตูุญู ุฑุง ุฑูุฑุด ฺฉูุฏ. ุฑู ุฏุฑุฎูุงุณุช ุงูู ฺฉูฺฉ ฺฉูุฏ. ุฏุฑ ุณูุช ููุงุจู ุฏูุจุงู Cookie ุจฺฏุฑุฏุฏ ู ุขูุฌุง ฺุฒ ฺฉู ููู ุงุณุช ููุฏุงุฑ sessionid ุงุณุช ู ุขู ุฑุง ฺฉูพ ุจฺฏุฑุฏ.

![Get Cookies](https://github.com/user-attachments/assets/7943bed5-ffae-4075-a2ba-29f091d572b4)

ุฏู ุฑูุด ุจุฑุง ุชูุธู ฺฉูฺฉ ุฏุฑ `config.json`:
1) ููุฏุงุฑ ูุณุชูู ุฏุฑ `auth.cookie`
2) ูุณุฑ ูุงู ฺฉูฺฉ ุฏุฑ `auth.cookieFile`

ููููู:
```json
{
  "auth": {
    "cookie": "csrftoken=...; sessionid=...;",
    "cookieFile": "",
    "sessionCookie": "",
    "sessionUpdated": ""
  }
}
```

ูฺฉุชู: ุงฺฏุฑ ฺฉูฺฉ ูพฺุฏู ุง ฺูุฏุฎุท ุงุณุชุ ุฑูุด ูุงู (`auth.cookieFile`) ุชูุตู ูโุดูุฏ.

## โถ๏ธ ุงุฌุฑุง
ููุงุด ุฑุงูููุง:
```powershell
node download.mjs --help 
```

ุงุฌุฑุง ุฏุงูููุฏ:
```powershell
node download.mjs "https://maktabkhooneh.org/course/<slug>/" 
```

ูพุดโููุงุด ูุจู ุงุฒ ุฏุงูููุฏ (ุจุฏูู ุฏุงูููุฏ ูุงูุน ูุงูโูุง):
```powershell
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --dry-run
```

ุงุฌุฑุง ุฏุงูููุฏ ุจุง ุชูุธูุงุช ูุงู ฺฉุงููฺฏ:
```bash
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --config ./config.json
```

ุงุฌุจุงุฑ ูุฑูุฏ ูุฌุฏุฏ:
```powershell
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --force-login
```

ูฺฉุชู: ุขุฏุฑุณ ุตูุญู ุฏูุฑูโ ููุฑุฏ ูุธุฑ ุฑุง ุฏุฑ ุฏุณุชูุฑุงุช ููู ุฌุงฺฏุฒู ฺฉูุฏ.

## ๐ ูพุดโููุงุด ูุจู ุงุฒ ุฏุงูููุฏ (Dry Run)
ุงฺฏุฑ ูโุฎูุงูุฏ ูุจู ุงุฒ ูุตุฑู ุงูุชุฑูุชุ ุจุฑุขูุฑุฏ ุฎูุจ ุงุฒ ุญุฌู ุฏุงูููุฏ ุฏุงุดุชู ุจุงุดุฏ:

```bash
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --dry-run
```

ุฏุฑ ุงู ุญุงูุช:
- ูฺ ูุงู ุฏุงูููุฏ ููโุดูุฏ.
- ูพูุดู/ูุงู ุฎุฑูุฌ ุณุงุฎุชู ููโุดูุฏ.
- ุจุฑุง ูุฑ ูุณูุชุ ููุงุฑุฏ ุฒุฑ ููุงุด ุฏุงุฏู ูโุดูุฏ:
  - ุญุฌู ุชูุฑุจ ูุฏู
  - ุชุนุฏุงุฏ ู ุญุฌู ุชูุฑุจ ุฒุฑููุณโูุง
  - ุชุนุฏุงุฏ ู ุญุฌู ุชูุฑุจ ุถูููโูุง
  - ูุณุฑ ุฎุฑูุฌ ูุงู
- ุจุฑุง ูุฑ ูุตูุ ุฎูุงุตูโ ุญุฌู ุชูุฑุจ ููุงุด ุฏุงุฏู ูโุดูุฏ.
- ุฏุฑ ุงูุชูุงุ ุฌูุน ฺฉู ุญุฌู ุชูุฑุจ ฺฉู ุฏูุฑู ููุงุด ุฏุงุฏู ูโุดูุฏ.

ูฺฉุชู ููู:
- ุงูุฏุงุฒูโูุง ยซุชุฎููยป ูุณุชูุฏ ู ุจุฑ ุงุณุงุณ ุงุทูุงุนุงุช ฺฉู ุณุฑูุฑ ุงุฒ ุทุฑู `HEAD/Range` ูโุฏูุฏ ูุญุงุณุจู ูโุดููุฏ.
- ุงฺฏุฑ ุจุฑุง ุจุนุถ ุขุชูโูุง ุงูุฏุงุฒู ูุงุจู ุชุดุฎุต ูุจุงุดุฏุ ุจู ุตูุฑุช `unknown` ฺฏุฒุงุฑุด ูโุดููุฏ.

## ๐งช ุชุณุช ุนููฺฉุฑุฏ
ุญุงูุช ูููููโฺฏุฑ (ูุซูุงู 64KB ุงูู ูุฑ ูุฏู):

```powershell
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --sample-bytes 65536 --verbose
```

ููฺูู ูโุชูุงูุฏ ููุฏุงุฑ ูููููโฺฏุฑ ุฑุง ุจุง ูุชุบุฑ ูุญุท ุณุช ฺฉูุฏ:
```json
{
  "runtime": {
    "sampleBytes": 512000
  }
}
```

## ๐ฏ ุฏุงูููุฏ ุงูุชุฎุงุจ (ูุตู/ูุณูุช)
ูโุชูุงูุฏ ุฏุงูููุฏ ุฑุง ูุญุฏูุฏ ฺฉูุฏ ุจู ูุตู ุง ูุณูุชโูุง ูุดุฎุต:

```bash
# ููุท ูุตู 2
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --chapter 2

# ูุตู 2 ู ููุท ูุณูุชโูุง 2 ุชุง 5 ู 9
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --chapter 2 --lesson 2-5,9

# ฺูุฏ ูุตู
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --chapter 1,3

# ูพุดโููุงุด ููุท ุจุฑุง ูุตู 2 ู ูุณูุชโูุง 2 ุชุง 5 ู 9
node download.mjs "https://maktabkhooneh.org/course/<slug>/" --dry-run --chapter 2 --lesson 2-5,9
```

ูุฑูุช ูุนุชุจุฑ ุจุฑุง `--chapter` ู `--lesson`:
- ุนุฏุฏ ุชฺฉ: `2`
- ูุณุช: `1,3,7`
- ุจุงุฒู: `2-5`
- ุชุฑฺฉุจ: `2-5,9`

## โป๏ธ Retry ู Timeout
ุจู ุตูุฑุช ูพุดโูุฑุถุ ุงุจุฒุงุฑ ุจุฑุง ุฎุทุงูุง ูููุช ุดุจฺฉูุ timeout ู ุฎุทุงูุง 5xx ุจุง **Exponential Backoff** ุฏูุจุงุฑู ุชูุงุด ูโฺฉูุฏ.

- `retry attempts` ูพุดโูุฑุถ: `4`
- `request timeout` ูพุดโูุฑุถ: `30000` ููโุซุงูู
- `read timeout` ูพุดโูุฑุถ: `120000` ููโุซุงูู

ุชูุธู ุงุฒ ุทุฑู `config.json`:
```bash
{
  "runtime": {
    "retryAttempts": 5,
    "requestTimeoutMs": 45000,
    "readTimeoutMs": 180000
  }
}
```

## โ๏ธ ูุงู ฺฉุงููฺฏ
ูุงู ูพุดโูุฑุถ ุงุจุฒุงุฑ `config.json` ุงุณุช (ุฏุฑ ุฑุดู ูพุฑูฺู).  
ุงฺฏุฑ ุงู ูุงู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุงุจุฒุงุฑ ุจุง ููุฏุงุฑูุง ูพุดโูุฑุถ ุงุฌุฑุง ูโุดูุฏ ู ูโุชูุงูุฏ ูุณุฑ ุณูุงุฑุด ุฑุง ุจุง `--config` ุจุฏูุฏ.

ูููููโ ุขูุงุฏู:
- `config.example.json` (ุจุฑุง ฺฉูพ ู ุดุฎุตโุณุงุฒ)

ููููู ุณุงุฎุชุงุฑ:
```json
{
  "courseUrl": "https://maktabkhooneh.org/course/<slug>/",
  "auth": {
    "email": "you@example.com",
    "password": "Secret123",
    "cookie": "",
    "cookieFile": ""
  },
  "runtime": {
    "sampleBytes": 0,
    "retryAttempts": 4,
    "requestTimeoutMs": 30000,
    "readTimeoutMs": 120000
  },
  "defaults": {
    "chapter": "",
    "lesson": "",
    "dryRun": false,
    "forceLogin": false,
    "verbose": false
  }
}
```

## ๐ ุณุงุฎุชุงุฑ ุฎุฑูุฌ
ููู ูุงูโูุง ุฏุฑ ุฒุฑ ูพูุดู ุฒุฑ ุฏุงูููุฏ ู ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ:
```
download/<ูุงู ุฏูุฑู>
```

## ๐ ูฺฉุงุช ุงููุช
- ูุงู `config.json` ูโุชูุงูุฏ ุดุงูู ฺฉูฺฉ ูุดุณุช ู ุงุทูุงุนุงุช ูุงฺฏู ุจุงุดุฏุ ูุฑฺฏุฒ ุขู ุฑุง ุจู ุงุดุชุฑุงฺฉ ูฺฏุฐุงุฑุฏ.
- ุงุฒ ูุฑุงุฑุฏุงุฏู ูพุณูุฑุฏ ุฎุงู ุฏุฑ ุชุงุฑุฎฺู ุดู ุฎูุฏุฏุงุฑ ฺฉูุฏ (ูโุชูุงูุฏ ุงุฒ ฺฉ ุงุณฺฉุฑูพุช ูููุช ุง ูุชุบุฑ ูููุช ุงุณุชูุงุฏู ฺฉูุฏ).

## ๐ค ููุณูุฏู
- ููุณูุฏู/ูฺฏูุฏุงุฑูุฏู: [NabiKAZ](https://github.com/NabiKAZ)
- ุชูุชุฑ (X): [https://x.com/NabiKAZ](https://x.com/NabiKAZ)
- ุชูฺฏุฑุงู: [https://t.me/BotSorati](https://t.me/BotSorati)

## โญ ุญูุงุช ู ุฏููุช
ุงฺฏุฑ ุงู ูพุฑูฺู ุจุฑุงุชุงู ููุฏ ุจูุฏุ ูุทูุงู ุฏุฑ ฺฏุชโูุงุจ ุจู ุขู ฺฉ โญ ุณุชุงุฑู ุจุฏูุฏ. \
ุจุฑุง ุญูุงุช ุงุฒ ุชูุณุนูโูุง ุจุนุฏ ูโุชูุงูุฏ ุจู ฺฉู ูพูู ุฒุฑุ TON ุฏููุช ฺฉูุฏ: \
**TON Wallet:** `nabikaz.ton` \
ุญูุงุช ุดูุง ุจุงุนุซ ุฏูฺฏุฑู ุงุณุช.

## ๐ ูุงุณูุณ
ุชุญุช ูุฌูุฒ GPL v3.0 โ ูุชู ฺฉุงูู ุฏุฑ ูุงู [LICENSE](./LICENSE).

ุณุงุฎุชูโุดุฏู ุจุง โค๏ธ ุจู ฺฉูฺฉ GPT-5
